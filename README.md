# Утилита ping_mac

Простая утилита для Linux, написанная на C++17, которая отправляет один ICMP (ping) запрос на указанный IPv4-адрес и выводит в консоль MAC-адрес хоста, от которого пришел ответ.

## Как это работает?

В основе утилиты лежит работа с низкоуровневыми сетевыми сокетами для полного контроля над отправкой и приемом пакетов.

1.  **Отправка запроса**: Создается "сырой" сокет (`raw socket`) типа `AF_INET`, который позволяет вручную сформировать и отправить ICMP-пакет (Echo-запрос) на целевой IP-адрес.
2.  **Прием ответа**: Одновременно открывается другой сокет типа `AF_PACKET`, который способен перехватывать целиком Ethernet-кадры на сетевом интерфейсе.
3.  **Анализ кадра**: После получения ответного пакета утилита анализирует его заголовки. Она проверяет, что это IP-пакет, содержащий ICMP-ответ от нужного хоста. Если все проверки проходят, из заголовка Ethernet-кадра (L2) извлекается MAC-адрес источника.

**Важное замечание:** Если целевой хост находится за пределами вашей локальной сети (например, `8.8.8.8`), утилита вернет MAC-адрес вашего **шлюза (роутера)**, а не конечного сервера. Это связано с тем, как работает маршрутизация на канальном уровне (L2).

## Сборка

Для сборки проекта необходимы компилятор C++, поддерживающий стандарт C++17 (например, `g++`), и утилита `make`.

```bash
make
```
## **Использование**

### **Запуск утилиты**

Для запуска утилиты требуются **права суперпользователя (root)**, так как она использует низкоуровневые raw-сокеты.

**Синтаксис:**

```bash  
sudo ./ping_mac <IPv4-адрес>
```
* `<IPv4-адрес>` — единственный обязательный аргумент. Это целевой IPv4-адрес, на который будет отправлен ICMP-запрос.

### **Примеры**

**1\. Запрос к устройству в локальной сети**

Запрос к вашему роутеру или другому компьютеру в локальной сети. Утилита вернет реальный MAC-адрес этого устройства.

```bash  
sudo ./ping_mac 192.168.1.1
```

**2\. Запрос к удаленному серверу в интернете**

В этом случае утилита вернет MAC-адрес вашего шлюза (роутера), через который пакет отправляется в интернет.

```bash  
sudo ./ping_mac 8.8.8.8
```
### **Возможные результаты работы**

**Успешное выполнение:**  
Отправлен ICMP запрос на 192.168.1.1  
Ответ от 192.168.1.1. MAC адрес: 1A:2B:3C:4D:5E:6F

* **Таймаут:** Если целевой хост не отвечает в течение 3 секунд (недоступен или заблокирован брандмауэром), программа сообщит об этом.  
Отправлен ICMP запрос на 192.168.1.100  
Таймаут: ответ не получен.

* **Ошибка ввода:** При некорректном IP-адресе или отсутствии аргумента будет выведено сообщение об ошибке.  
  Ошибка: неверный IPv4 адрес '192.168.1.abc'

